<!DOCTYPE HTML>
<html lang="en-US" manifest="./manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Meta-Bookworm | Bookworm</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="bmschmidt">
        <meta name="description" content="Bookworm makes it easy to interactively explore massive collections of texts as data.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        
        <link rel="prev" href="./Future.html" />
        

        <meta property="og:title" content="Meta-Bookworm | Bookworm">
        <meta property="og:site_name" content="Bookworm">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/bmschmidt">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="gitbook/style.css">
        


        
    <div class="book" data-github="bmschmidt/Presidio" data-level="9.1" data-basepath="." data-revision="1400774513665">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/bmschmidt/Presidio" target="_blank" class="btn pull-left"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/bmschmidt/Presidio/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/bmschmidt/Presidio/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="./" >Bookworm</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/bmschmidt" target="blank">About the author</a>
        </li>
        

        
        <li>
            <a href="https://github.com/bmschmidt/Presidio/issues" target="blank">Questions and Issues</a>
        </li>
        

        
        <li>
            <a href="https://github.com/bmschmidt/Presidio/edit/master/Metaworm.md" target="blank">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="Why.html">
                
                <a href="./Why.html">
                    <i class="fa fa-check"></i> <b>1.</b> Why Bookworm?
                </a>
                
                
            </li>
        
            <li  data-level="2" data-path="Building.html">
                
                <a href="./Building.html">
                    <i class="fa fa-check"></i> <b>2.</b> Building a Bookworm
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="MySQL.html">
                            
                            <a href="./MySQL.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Configuring MySQL and Apache
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="Requirements.html">
                            
                            <a href="./Requirements.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Required Files
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="input.txt.html">
                            
                            <a href="./input.txt.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> input.txt
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="JSONcatalog.html">
                            
                            <a href="./JSONcatalog.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> The jsoncatalog.txt
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="field_descriptions.json.html">
                            
                            <a href="./field_descriptions.json.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> field_descriptions.json
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="Running.html">
                            
                            <a href="./Running.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Running the script
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.7" data-path="Example.html">
                            
                            <a href="./Example.html">
                                <i class="fa fa-check"></i> <b>2.7.</b> An example workflow
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.8" data-path="Maintenance.html">
                            
                            <a href="./Maintenance.html">
                                <i class="fa fa-check"></i> <b>2.8.</b> Maintenance
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="Hierarchies.html">
                
                <a href="./Hierarchies.html">
                    <i class="fa fa-check"></i> <b>3.</b> Adding Hierarchical Data
                </a>
                
                
            </li>
        
            <li  data-level="4" data-path="API.html">
                
                <a href="./API.html">
                    <i class="fa fa-check"></i> <b>4.</b> The Bookworm API
                </a>
                
                
            </li>
        
            <li  data-level="5" data-path="Tokens.html">
                
                <a href="./Tokens.html">
                    <i class="fa fa-check"></i> <b>5.</b> Defining a Token
                </a>
                
                
            </li>
        
            <li  data-level="6" data-path="Websites.html">
                
                <a href="./Websites.html">
                    <i class="fa fa-check"></i> <b>6.</b> Web Front Ends
                </a>
                
                
            </li>
        
            <li  data-level="7" data-path="OneClick.html">
                
                <a href="./OneClick.html">
                    <i class="fa fa-check"></i> <b>7.</b> The One Click Infrastructure
                </a>
                
                
            </li>
        
            <li  data-level="8" data-path="Extensions.html">
                
                <a href="./Extensions.html">
                    <i class="fa fa-check"></i> <b>8.</b> Extensions
                </a>
                
                
            </li>
        
            <li  data-level="9" data-path="Future.html">
                
                <a href="./Future.html">
                    <i class="fa fa-check"></i> <b>9.</b> Future Plans
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="9.1" data-path="Metaworm.html">
                            
                            <a href="./Metaworm.html">
                                <i class="fa fa-check"></i> <b>9.1.</b> Meta-Bookworm
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 100%;min-width: 94.44444444444444%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./Why.html" title="Why Bookworm?" class="chapter done new-chapter" data-progress="1" style="left: 5.555555555555555%;"></a>
    
        <a href="./Building.html" title="Building a Bookworm" class="chapter done new-chapter" data-progress="2" style="left: 11.11111111111111%;"></a>
    
        <a href="./MySQL.html" title="Configuring MySQL and Apache" class="chapter done " data-progress="2.1" style="left: 16.666666666666668%;"></a>
    
        <a href="./Requirements.html" title="Required Files" class="chapter done " data-progress="2.2" style="left: 22.22222222222222%;"></a>
    
        <a href="./input.txt.html" title="input.txt" class="chapter done " data-progress="2.3" style="left: 27.77777777777778%;"></a>
    
        <a href="./JSONcatalog.html" title="The jsoncatalog.txt" class="chapter done " data-progress="2.4" style="left: 33.333333333333336%;"></a>
    
        <a href="./field_descriptions.json.html" title="field_descriptions.json" class="chapter done " data-progress="2.5" style="left: 38.888888888888886%;"></a>
    
        <a href="./Running.html" title="Running the script" class="chapter done " data-progress="2.6" style="left: 44.44444444444444%;"></a>
    
        <a href="./Example.html" title="An example workflow" class="chapter done " data-progress="2.7" style="left: 50%;"></a>
    
        <a href="./Maintenance.html" title="Maintenance" class="chapter done " data-progress="2.8" style="left: 55.55555555555556%;"></a>
    
        <a href="./Hierarchies.html" title="Adding Hierarchical Data" class="chapter done new-chapter" data-progress="3" style="left: 61.111111111111114%;"></a>
    
        <a href="./API.html" title="The Bookworm API" class="chapter done new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="./Tokens.html" title="Defining a Token" class="chapter done new-chapter" data-progress="5" style="left: 72.22222222222223%;"></a>
    
        <a href="./Websites.html" title="Web Front Ends" class="chapter done new-chapter" data-progress="6" style="left: 77.77777777777777%;"></a>
    
        <a href="./OneClick.html" title="The One Click Infrastructure" class="chapter done new-chapter" data-progress="7" style="left: 83.33333333333333%;"></a>
    
        <a href="./Extensions.html" title="Extensions" class="chapter done new-chapter" data-progress="8" style="left: 88.88888888888889%;"></a>
    
        <a href="./Future.html" title="Future Plans" class="chapter done new-chapter" data-progress="9" style="left: 94.44444444444444%;"></a>
    
        <a href="./Metaworm.html" title="Meta-Bookworm" class="chapter done " data-progress="9.1" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_38">
                    
                        <h1 id="meta-bookworm">Meta-Bookworm</h1>
<p>Bookworm currently has a 16 million document limit. This corresponds to the maximum size of an unsigned, 3-byte integer in MySQL. It would be possible to simply change that to a 4-byte integer; but around 8 million texts, Bookworm queries start to get a bit slow a lot of the time.</p>
<p>The reason has to do with the bottleneck on a query.
There are two different constraints on query time:</p>
<ul>
<li>The word lookup queries (time increases as O(log(n))).</li>
<li>The merges with the catalog (time increases as O(n)).</li>
</ul>
<p>Queries on smallish (under 500,000 documents) bookworms take trivial amounts of time, perhaps because they&#39;re throttled by the first element; on large bookworms, the scaling seems to be dominated by the linear scaling.</p>
<p>One fascinating, if slightly problematic, solution would be to implement a <strong>meta-bookworm</strong>: that is, an implementation of the Bookworm API that runs not on a database, but that dispatches to a number of different API instances itself.</p>
<p>So given a &quot;word per million&quot; query grouped by year, it would &quot;know&quot; 10 servers associated with that database; it would dispatch wordcount and totalWords queries to each of them; and as the results came back in, it would merge them together into a single result set. (I imagine this being written in python using pandas to optimize merges, but other options are possible).</p>
<p><strong>Creation</strong></p>
<p>This would be created by dispatching, at creation time, the individual documents randomly across a number of different servers. (I think random distribution would be the fastest for queries). Each server would then have a functioning MySQL (or Solr, or whatever) Bookworm.</p>
<p>Creation times would be faster significantly than on the current Bookworms; most of the build scales as O(n), and index creation is O(n*log(n)).</p>
<p><strong>Running on existing Bookworms</strong></p>
<p>It could also be deploted across existing sets of Bookworms: if, for example, multiple institutions included newspapers with similar metadata, someone could implement a meta-bookworm that returned intersecting fields from the various bookworms. (In fact, the meta-bookworm spec could be defined to look for intersections in a <code>return_available_fields</code> call). Then, you could have a single GUI plotting results from multiple different collections, returning links to different elements.</p>
<p><strong>Problems</strong></p>
<p>At smaller bookworms, this might be slower than a single bookworm, particularly if there are O(log(n)) dynamics at play.</p>
<p>Connection and merge overhead times make me suspect this is probably only sensible with more than 3 or 4 servers; just 2 would be silly.</p>
<p>If one server is down, the entire Bookworm will time out. It could return results on partial implementations, or it could be defined to have multiple copies of each server, and to use whichever returns first.</p>
<p><strong>And the central farm</strong></p>
<p>For a central distributed installation at Chicago, say, this might be a way to distribute load evenly across a number of different servers. Particularly when spikes in use will be different by different bookworms, this would nicely smooth out use.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./Future.html" class="navigation navigation-prev navigation-unique"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="gitbook/app.js"></script>
        

    
    <script src="gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
